FROM node:18-alpine

WORKDIR /app

# Copy only frontend
COPY frontend/package.json frontend/package-lock.json* ./

# Install with npm (more stable than yarn in Docker)
RUN npm ci --legacy-peer-deps || npm install --legacy-peer-deps

# Copy frontend source
COPY frontend/ ./

# Build
RUN npm run build

# Install serve
RUN npm install -g serve

EXPOSE 3000

CMD ["serve", "-s", "build", "-p", "3000"]
